### 系统完整测试流程 (带说明)

### 说明：
### - 默认应用在首次启动时会自动创建初始管理员，用户名/密码 默认为 `admin` / `admin123`（见 `application.yml` 或 `InitialDataLoader`）。
### - 大多数管理接口需要在请求头中带 `Authorization: Bearer <JWT>`。
### - 下面测试按顺序执行；对于需要鉴权的请求，请先使用 `/auth/login` 获取 token 并在后续请求中添加 `Authorization` 头。
### 测试顺序：认证 -> 用户（管理员）-> 客房 -> 宾客 -> 预订 -> 支付回调

### 1. 用户管理测试

### 获取所有用户（需要管理员/经理权限）
GET http://localhost:8080/users
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### ---- 获取管理员 JWT（用于后续需要管理员权限的请求）
POST http://localhost:8080/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}

### 响应示例: { "token": "eyJ..." }
### 把返回的 token 填入下面的 Authorization 头用于需要鉴权的请求：
### Authorization: Bearer <token>

### 创建管理员用户（需要管理员权限）
POST http://localhost:8080/users
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "username": "admin2",
  "password": "admin123",
  "fullName": "系统管理员2",
  "email": "admin2@hotel.com",
  "phone": "13800138001",
  "role": "ADMIN"
}

### 创建前台用户（需要管理员权限）
POST http://localhost:8080/users
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "username": "reception",
  "password": "reception123",
  "fullName": "前台小李",
  "email": "reception@hotel.com",
  "phone": "13900139000",
  "role": "RECEPTIONIST"
}

### 获取所有用户（现在应该有管理员/前台等）
GET http://localhost:8080/users
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 2. 客房管理测试

### 获取所有客房（初始应为空或由种子数据决定）
GET http://localhost:8080/rooms
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 创建标准大床房（需要管理员/经理权限）
POST http://localhost:8080/rooms
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "roomNumber": "101",
  "roomType": "标准大床房",
  "description": "舒适的标准大床房，配备独立卫浴",
  "price": 299.00,
  "capacity": 2,
  "amenities": "WiFi,空调,电视,独立卫浴",
  "status": "AVAILABLE"
}

### 创建豪华双床房
POST http://localhost:8080/rooms
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "roomNumber": "201",
  "roomType": "豪华双床房",
  "description": "宽敞的豪华双床房，配备按摩浴缸",
  "price": 499.00,
  "capacity": 2,
  "amenities": "WiFi,空调,电视,按摩浴缸,迷你吧",
  "status": "AVAILABLE"
}

### 创建套房
POST http://localhost:8080/rooms
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "roomNumber": "301",
  "roomType": "豪华套房",
  "description": "奢华的豪华套房，配备客厅和卧室",
  "price": 899.00,
  "capacity": 4,
  "amenities": "WiFi,空调,电视,按摩浴缸,迷你吧,客厅,阳台",
  "status": "AVAILABLE"
}

### 获取所有客房（现在应该有3个房间）
GET http://localhost:8080/rooms
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 获取可用客房
GET http://localhost:8080/rooms/available
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 根据房型查询
GET http://localhost:8080/rooms/type/标准大床房
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 根据ID获取客房
GET http://localhost:8080/rooms/1
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 更新客房信息（需要管理员权限）
PUT http://localhost:8080/rooms/1
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "roomNumber": "101",
  "roomType": "升级大床房",
  "description": "升级版舒适大床房，配备独立卫浴和办公区",
  "price": 349.00,
  "capacity": 2,
  "amenities": "WiFi,空调,电视,独立卫浴,办公桌",
  "status": "AVAILABLE",
  "isActive": true
}

### 3. 宾客管理测试

### 获取所有宾客（初始应为空）
GET http://localhost:8080/guests
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 创建宾客1（对外开放，可直接注册）
POST http://localhost:8080/guests
Content-Type: application/json

{
  "fullName": "张三",
  "idCardNumber": "110101199001011234",
  "phone": "13800138000",
  "email": "zhangsan@example.com",
  "password": "guestpass1",
  "gender": "MALE",
  "dateOfBirth": "1990-01-01",
  "address": "北京市朝阳区",
  "preferences": "无烟,高楼层",
  "specialRequests": "需要接机服务"
}

### 创建宾客2
POST http://localhost:8080/guests
Content-Type: application/json

{
  "fullName": "李四",
  "idCardNumber": "110101199002021235",
  "phone": "13900139000",
  "email": "lisi@example.com",
  "password": "guestpass2",
  "gender": "FEMALE",
  "dateOfBirth": "1990-02-02",
  "address": "上海市浦东新区",
  "preferences": "安静,有窗",
  "specialRequests": "需要婴儿床"
}

### 获取所有宾客（现在应该有2个宾客）
GET http://localhost:8080/guests
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 宾客登录（使用注册时的 `email` 与 `password`），获取宾客 token
POST http://localhost:8080/auth/login
Content-Type: application/json

{
  "username": "lisi@example.com",
  "password": "guestpass2"
}

### 将返回的 token 用于宾客创建自己的预订（Authorization: Bearer <GUEST_TOKEN>)

### 4. 预订管理测试

### 获取所有预订（初始应为空）
GET http://localhost:8080/reservations
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 创建预订1（张三预订101房间）
POST http://localhost:8080/reservations
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "guestId": 1,
  "roomId": 1,
  "checkInDate": "2025-10-20",
  "checkOutDate": "2025-10-22",
  "numberOfGuests": 2,
  "specialRequests": "需要鲜花布置",
  "createdBy": "admin"
}

### 创建预订2（李四预订201房间）
POST http://localhost:8080/reservations
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJsaXNpQGV4YW1wbGUuY29tIiwicm9sZXMiOiJST0xFX0dVRVNUIiwiaWF0IjoxNzYzNzQ3ODA1LCJleHAiOjE3NjM3NTE0MDV9.qHljboRtEfJ5fcloI3th5h1X4EOFMRFaOidm3o0sbJw

{
  "guestId": 2,
  "roomId": 2,
  "checkInDate": "2025-10-25",
  "checkOutDate": "2025-10-27",
  "numberOfGuests": 2,
  "specialRequests": "需要婴儿床",
  "createdBy": "reception"
}

### 获取所有预订（需要管理员或经理权限）
GET http://localhost:8080/reservations
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 根据宾客ID获取预订
GET http://localhost:8080/reservations/guest/1
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 根据房间ID获取预订
GET http://localhost:8080/reservations/room/1
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 根据状态获取预订
GET http://localhost:8080/reservations/status/CONFIRMED
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 根据入住日期范围查询
GET http://localhost:8080/reservations/checkin-range?start=2025-10-19&end=2025-10-26
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 根据ID获取预订
GET http://localhost:8080/reservations/1
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 取消预订（宾客可以取消自己的预订）
POST http://localhost:8080/reservations/1/cancel
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ6aGFuZ3NhbkBleGFtcGxlLmNvbSIsInJvbGVzIjoiUk9MRV9HVUVTVCIsImlhdCI6MTc2Mzc0NzYwMywiZXhwIjoxNzYzNzUxMjAzfQ.952fAjwJMUOBeuT8HCF-jLJHRtX4A8R7gY9V6tcC3IU

### 5. 业务逻辑验证测试

### 测试房间可用性（应该返回冲突，因为101房间已被预订）
POST http://localhost:8080/reservations
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "guestId": 2,
  "roomId": 1,
  "checkInDate": "2025-10-21",
  "checkOutDate": "2025-10-23",
  "numberOfGuests": 2,
  "specialRequests": "测试房间冲突",
  "createdBy": "admin"
}

### 测试可用客房（101房间应该不可用）
GET http://localhost:8080/rooms/available
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 6. 数据验证测试

### 测试重复用户名（应该返回错误）
POST http://localhost:8080/users
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "username": "admin",
  "password": "password123",
  "fullName": "测试用户",
  "email": "test@hotel.com",
  "phone": "13600136000",
  "role": "RECEPTIONIST"
}

### 测试重复房间号（应该返回错误）
POST http://localhost:8080/rooms
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "roomNumber": "101",
  "roomType": "测试房间",
  "description": "测试重复房间号",
  "price": 100.00,
  "capacity": 1,
  "amenities": "WiFi",
  "status": "AVAILABLE"
}

### 测试重复身份证号（应该返回错误）
POST http://localhost:8080/guests
Content-Type: application/json

{
  "fullName": "测试宾客",
  "idCardNumber": "110101199001011234",
  "phone": "13700137000",
  "email": "test@example.com",
  "gender": "MALE",
  "dateOfBirth": "1995-01-01",
  "address": "测试地址"
}

### 7. 清理测试数据（可选）

### 删除预订
DELETE http://localhost:8080/reservations/2
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 删除宾客
DELETE http://localhost:8080/guests/2
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 删除客房
DELETE http://localhost:8080/rooms/3
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### 删除用户
DELETE http://localhost:8080/users/4
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

### ----- 支付流程示例（用于触发付款成功后的占房逻辑）
### 1) 为某预订创建挂起付款（通常由前端在发起支付时调用）
POST http://localhost:8080/payments/create
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGVzIjoiUk9MRV9BRE1JTiIsImlhdCI6MTc2Mzc0NjE4MywiZXhwIjoxNzYzNzQ5NzgzfQ.jH6VM3dCxqS53efWzT3XPK0DpsxIbV3AsLryB_czBLI

{
  "reservationId": 1,
  "amount": 698.00,
  "note": "预订支付"
}

### 响应包含 transactionId，例如 { "transactionId": 123 }

### 2) 模拟支付回调（第三方支付在交易成功后调用此接口）
POST http://localhost:8080/payments/callback
Content-Type: application/json

{
  "transactionId": 123,
  "status": "SUCCESS",
  "providerTransactionId": "pay-abc-123"
}

### 说明：收到 SUCCESS 回调后，系统会把该交易标为成功，若为 PAYMENT 类型会把该预订的 `paidAmount` 更新并尝试分配房间（标为 RESERVED）。

